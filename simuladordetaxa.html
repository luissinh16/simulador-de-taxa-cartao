<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simulador de Taxas de Máquinas</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f5f7fb;
    margin: 0;
    padding: 30px;
    color: #333;
  }
  h1 {
    text-align: center;
    color: #0056b3;
  }
  .simulador {
    max-width: 700px;
    margin: 0 auto;
    background: #fff;
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 3px 15px rgba(0,0,0,0.1);
  }
  label {
    font-weight: bold;
    margin-top: 10px;
    display: block;
  }
  input, select {
    width: 100%;
    padding: 10px;
    margin-top: 5px;
    margin-bottom: 15px;
    border: 1px solid #ccc;
    border-radius: 6px;
    font-size: 15px;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
  }
  th, td {
    padding: 10px;
    border-bottom: 1px solid #eee;
    text-align: left;
  }
  th {
    background: #f0f0f0;
  }
  .valor {
    text-align: right;
    font-weight: bold;
  }
  .melhor {
    background: #d4edda !important;
    color: #155724 !important;
    font-weight: bold;
  }
</style>
</head>
<body>

<div class="simulador">
  <h1>Simulador de Taxas de Máquinas</h1>
  <h2>A opção operador NUBANK & ITAU tem tempo de processamento de 1 dia útil.</h2>

  <label for="valor">Valor da Venda (R$):</label>
  <input type="number" id="valor" placeholder="Ex: 150" step="0.01">

  <label for="parcelas">Quantidade de Parcelas:</label>
  <select id="parcelas">
    <option value="0">Débito</option>
    <option value="1">Crédito 1x</option>
    <option value="2">Crédito 2x</option>
    <option value="3">Crédito 3x</option>
    <option value="4">Crédito 4x</option>
    <option value="5">Crédito 5x</option>
    <option value="6">Crédito 6x</option>
    <option value="7">Crédito 7x</option>
    <option value="8">Crédito 8x</option>
    <option value="9">Crédito 9x</option>
    <option value="10">Crédito 10x</option>
    <option value="11">Crédito 11x</option>
    <option value="12">Crédito 12x</option>
  </select>

  <table>
    <thead>
      <tr>
        <th>Operadora</th>
        <th>Bandeira</th>
        <th>Valor Recebido (R$)</th>
      </tr>
    </thead>
    <tbody id="resultados"></tbody>
  </table>
</div>

<script>
const taxas = {
  "Itaú - Master/Visa": {
    debito: 0.87,
    credito: [3.41,4.56,5.35,6.14,6.93,7.72,8.82,9.61,10.40,11.19,11.98,12.77]
  },
  "Itaú - Elo": {
    debito: 1.68,
    credito: [4.21,5.36,6.15,6.94,7.73,8.52,9.62,10.41,11.20,11.99,12.78,13.57]
  },
  "Nubank": {
    debito: 0.89,
    credito: [3.09,5.79,6.09,7.99,8.09,8.19,9.49,9.68,10.37,11.05,12.27,12.38]
  },
  "Mercado Pago": {
    debito: 1.61,
    credito: [3.51,4.76,5.65,6.34,7.13,7.92,9.02,9.81,10.60,11.39,12.18,12.97]
  },
  "PágBank": {
    debito: 1.61,
    credito: [4.00,4.86,5.75,6.62,7.49,8.34,9.59,10.42,11.24,12.05,12.85,13.65]
  }
};

const resultados = document.getElementById("resultados");
const valorInput = document.getElementById("valor");
const parcelasInput = document.getElementById("parcelas");

function formatar(valor) {
  return valor.toLocaleString("pt-BR", { style: "currency", currency: "BRL" });
}

function calcular() {
  resultados.innerHTML = "";
  const valor = parseFloat(valorInput.value);
  const parcelas = parseInt(parcelasInput.value);

  if (isNaN(valor) || valor <= 0) return;

  const taxaExtra = 1.0; // Taxa de processamento
  const listaResultados = [];

  for (const [operadora, dados] of Object.entries(taxas)) {
    let bandeiras = ["Master/Visa"];
    if (operadora.includes("Elo")) bandeiras = ["Elo"];
    if (operadora === "Nubank" || operadora === "Mercado Pago" || operadora === "PágBank")
      bandeiras = ["Master/Visa/Elo"];

    bandeiras.forEach(bandeira => {
      let taxa = 0;
      if (parcelas === 0) {
        taxa = dados.debito || 0;
      } else {
        taxa = dados.credito[parcelas - 1] || dados.credito[dados.credito.length - 1];
      }
      taxa += taxaExtra;
      const valorFinal = valor - (valor * (taxa / 100));
      listaResultados.push({ operadora, bandeira, valorFinal });
    });
  }

  // Ordenar do maior para o menor valor recebido
  listaResultados.sort((a, b) => b.valorFinal - a.valorFinal);

  // Exibir resultados e destacar a melhor
  listaResultados.forEach((item, index) => {
    const tr = document.createElement("tr");
    if (index === 0) tr.classList.add("melhor");
    tr.innerHTML = `
      <td>${item.operadora}</td>
      <td>${item.bandeira}</td>
      <td class="valor">${formatar(item.valorFinal)}</td>
    `;
    resultados.appendChild(tr);
  });
}

valorInput.addEventListener("input", calcular);
parcelasInput.addEventListener("change", calcular);
</script>

</body>
</html>